(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,98183,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0});var r={assign:function(){return o},searchParamsToUrlQuery:function(){return n},urlQueryToSearchParams:function(){return i}};for(var a in r)Object.defineProperty(s,a,{enumerable:!0,get:r[a]});function n(e){let t={};for(let[s,r]of e.entries()){let e=t[s];void 0===e?t[s]=r:Array.isArray(e)?e.push(r):t[s]=[e,r]}return t}function l(e){return"string"==typeof e?e:("number"!=typeof e||isNaN(e))&&"boolean"!=typeof e?"":String(e)}function i(e){let t=new URLSearchParams;for(let[s,r]of Object.entries(e))if(Array.isArray(r))for(let e of r)t.append(s,l(e));else t.set(s,l(r));return t}function o(e,...t){for(let s of t){for(let t of s.keys())e.delete(t);for(let[t,r]of s.entries())e.append(t,r)}return e}},95057,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0});var r={formatUrl:function(){return i},formatWithValidation:function(){return c},urlObjectKeys:function(){return o}};for(var a in r)Object.defineProperty(s,a,{enumerable:!0,get:r[a]});let n=e.r(90809)._(e.r(98183)),l=/https?|ftp|gopher|file/;function i(e){let{auth:t,hostname:s}=e,r=e.protocol||"",a=e.pathname||"",i=e.hash||"",o=e.query||"",c=!1;t=t?encodeURIComponent(t).replace(/%3A/i,":")+"@":"",e.host?c=t+e.host:s&&(c=t+(~s.indexOf(":")?`[${s}]`:s),e.port&&(c+=":"+e.port)),o&&"object"==typeof o&&(o=String(n.urlQueryToSearchParams(o)));let d=e.search||o&&`?${o}`||"";return r&&!r.endsWith(":")&&(r+=":"),e.slashes||(!r||l.test(r))&&!1!==c?(c="//"+(c||""),a&&"/"!==a[0]&&(a="/"+a)):c||(c=""),i&&"#"!==i[0]&&(i="#"+i),d&&"?"!==d[0]&&(d="?"+d),a=a.replace(/[?#]/g,encodeURIComponent),d=d.replace("#","%23"),`${r}${c}${a}${d}${i}`}let o=["auth","hash","host","hostname","href","path","pathname","port","protocol","query","search","slashes"];function c(e){return i(e)}},18581,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"useMergedRef",{enumerable:!0,get:function(){return a}});let r=e.r(71645);function a(e,t){let s=(0,r.useRef)(null),a=(0,r.useRef)(null);return(0,r.useCallback)(r=>{if(null===r){let e=s.current;e&&(s.current=null,e());let t=a.current;t&&(a.current=null,t())}else e&&(s.current=n(e,r)),t&&(a.current=n(t,r))},[e,t])}function n(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let s=e(t);return"function"==typeof s?s:()=>e(null)}}("function"==typeof s.default||"object"==typeof s.default&&null!==s.default)&&void 0===s.default.__esModule&&(Object.defineProperty(s.default,"__esModule",{value:!0}),Object.assign(s.default,s),t.exports=s.default)},18967,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0});var r={DecodeError:function(){return y},MiddlewareNotFoundError:function(){return _},MissingStaticPage:function(){return b},NormalizeError:function(){return f},PageNotFoundError:function(){return v},SP:function(){return m},ST:function(){return g},WEB_VITALS:function(){return n},execOnce:function(){return l},getDisplayName:function(){return u},getLocationOrigin:function(){return c},getURL:function(){return d},isAbsoluteUrl:function(){return o},isResSent:function(){return h},loadGetInitialProps:function(){return p},normalizeRepeatedSlashes:function(){return x},stringifyError:function(){return j}};for(var a in r)Object.defineProperty(s,a,{enumerable:!0,get:r[a]});let n=["CLS","FCP","FID","INP","LCP","TTFB"];function l(e){let t,s=!1;return(...r)=>(s||(s=!0,t=e(...r)),t)}let i=/^[a-zA-Z][a-zA-Z\d+\-.]*?:/,o=e=>i.test(e);function c(){let{protocol:e,hostname:t,port:s}=window.location;return`${e}//${t}${s?":"+s:""}`}function d(){let{href:e}=window.location,t=c();return e.substring(t.length)}function u(e){return"string"==typeof e?e:e.displayName||e.name||"Unknown"}function h(e){return e.finished||e.headersSent}function x(e){let t=e.split("?");return t[0].replace(/\\/g,"/").replace(/\/\/+/g,"/")+(t[1]?`?${t.slice(1).join("?")}`:"")}async function p(e,t){let s=t.res||t.ctx&&t.ctx.res;if(!e.getInitialProps)return t.ctx&&t.Component?{pageProps:await p(t.Component,t.ctx)}:{};let r=await e.getInitialProps(t);if(s&&h(s))return r;if(!r)throw Object.defineProperty(Error(`"${u(e)}.getInitialProps()" should resolve to an object. But found "${r}" instead.`),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return r}let m="undefined"!=typeof performance,g=m&&["mark","measure","getEntriesByName"].every(e=>"function"==typeof performance[e]);class y extends Error{}class f extends Error{}class v extends Error{constructor(e){super(),this.code="ENOENT",this.name="PageNotFoundError",this.message=`Cannot find module for page: ${e}`}}class b extends Error{constructor(e,t){super(),this.message=`Failed to load static file for page: ${e} ${t}`}}class _ extends Error{constructor(){super(),this.code="ENOENT",this.message="Cannot find the middleware module"}}function j(e){return JSON.stringify({message:e.message,stack:e.stack})}},73668,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"isLocalURL",{enumerable:!0,get:function(){return n}});let r=e.r(18967),a=e.r(52817);function n(e){if(!(0,r.isAbsoluteUrl)(e))return!0;try{let t=(0,r.getLocationOrigin)(),s=new URL(e,t);return s.origin===t&&(0,a.hasBasePath)(s.pathname)}catch(e){return!1}}},84508,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"errorOnce",{enumerable:!0,get:function(){return r}});let r=e=>{}},22016,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0});var r={default:function(){return y},useLinkStatus:function(){return v}};for(var a in r)Object.defineProperty(s,a,{enumerable:!0,get:r[a]});let n=e.r(90809),l=e.r(43476),i=n._(e.r(71645)),o=e.r(95057),c=e.r(8372),d=e.r(18581),u=e.r(18967),h=e.r(5550);e.r(33525);let x=e.r(91949),p=e.r(73668),m=e.r(9396);function g(e){return"string"==typeof e?e:(0,o.formatUrl)(e)}function y(t){var s;let r,a,n,[o,y]=(0,i.useOptimistic)(x.IDLE_LINK_STATUS),v=(0,i.useRef)(null),{href:b,as:_,children:j,prefetch:N=null,passHref:w,replace:S,shallow:k,scroll:M,onClick:R,onMouseEnter:C,onTouchStart:E,legacyBehavior:$=!1,onNavigate:P,ref:A,unstable_dynamicOnHover:T,...D}=t;r=j,$&&("string"==typeof r||"number"==typeof r)&&(r=(0,l.jsx)("a",{children:r}));let O=i.default.useContext(c.AppRouterContext),F=!1!==N,L=!1!==N?null===(s=N)||"auto"===s?m.FetchStrategy.PPR:m.FetchStrategy.Full:m.FetchStrategy.PPR,{href:H,as:I}=i.default.useMemo(()=>{let e=g(b);return{href:e,as:_?g(_):e}},[b,_]);if($){if(r?.$$typeof===Symbol.for("react.lazy"))throw Object.defineProperty(Error("`<Link legacyBehavior>` received a direct child that is either a Server Component, or JSX that was loaded with React.lazy(). This is not supported. Either remove legacyBehavior, or make the direct child a Client Component that renders the Link's `<a>` tag."),"__NEXT_ERROR_CODE",{value:"E863",enumerable:!1,configurable:!0});a=i.default.Children.only(r)}let B=$?a&&"object"==typeof a&&a.ref:A,U=i.default.useCallback(e=>(null!==O&&(v.current=(0,x.mountLinkInstance)(e,H,O,L,F,y)),()=>{v.current&&((0,x.unmountLinkForCurrentNavigation)(v.current),v.current=null),(0,x.unmountPrefetchableInstance)(e)}),[F,H,O,L,y]),V={ref:(0,d.useMergedRef)(U,B),onClick(t){$||"function"!=typeof R||R(t),$&&a.props&&"function"==typeof a.props.onClick&&a.props.onClick(t),!O||t.defaultPrevented||function(t,s,r,a,n,l,o){if("undefined"!=typeof window){let c,{nodeName:d}=t.currentTarget;if("A"===d.toUpperCase()&&((c=t.currentTarget.getAttribute("target"))&&"_self"!==c||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey||t.nativeEvent&&2===t.nativeEvent.which)||t.currentTarget.hasAttribute("download"))return;if(!(0,p.isLocalURL)(s)){n&&(t.preventDefault(),location.replace(s));return}if(t.preventDefault(),o){let e=!1;if(o({preventDefault:()=>{e=!0}}),e)return}let{dispatchNavigateAction:u}=e.r(99781);i.default.startTransition(()=>{u(r||s,n?"replace":"push",l??!0,a.current)})}}(t,H,I,v,S,M,P)},onMouseEnter(e){$||"function"!=typeof C||C(e),$&&a.props&&"function"==typeof a.props.onMouseEnter&&a.props.onMouseEnter(e),O&&F&&(0,x.onNavigationIntent)(e.currentTarget,!0===T)},onTouchStart:function(e){$||"function"!=typeof E||E(e),$&&a.props&&"function"==typeof a.props.onTouchStart&&a.props.onTouchStart(e),O&&F&&(0,x.onNavigationIntent)(e.currentTarget,!0===T)}};return(0,u.isAbsoluteUrl)(I)?V.href=I:$&&!w&&("a"!==a.type||"href"in a.props)||(V.href=(0,h.addBasePath)(I)),n=$?i.default.cloneElement(a,V):(0,l.jsx)("a",{...D,...V,children:r}),(0,l.jsx)(f.Provider,{value:o,children:n})}e.r(84508);let f=(0,i.createContext)(x.IDLE_LINK_STATUS),v=()=>(0,i.useContext)(f);("function"==typeof s.default||"object"==typeof s.default&&null!==s.default)&&void 0===s.default.__esModule&&(Object.defineProperty(s.default,"__esModule",{value:!0}),Object.assign(s.default,s),t.exports=s.default)},52683,e=>{"use strict";var t=e.i(43476),s=e.i(71645),r=e.i(22016),a=e.i(34983);function n(e,t,s=5,r=!1){if(null===e||null===t||0===t)return null;let a=(e-t)/t*100;return{direction:Math.abs(a)<s?"stable":a>0?r?"down":"up":r?"up":"down",change_pct:Math.round(10*a)/10,baseline:t,current:e}}function l(e,t=7){let s=e.slice(0,t).filter(e=>null!==e);return s.length<3?null:Math.round(s.reduce((e,t)=>e+t,0)/s.length*100)/100}function i(e,t,s,r){let a=[],n=[];if(null!==e&&null!==r.hrv_7d_avg){let t=Math.min(100,Math.max(0,80*(e/r.hrv_7d_avg)+20));a.push(1.5*t),n.push(1.5)}if(null!==t&&null!==r.sleep_7d_avg){let e=Math.min(100,Math.max(0,85*(t/r.sleep_7d_avg)+15));a.push(e),n.push(1)}if(null!==s&&(a.push(s),n.push(1)),0===a.length)return 0;let l=n.reduce((e,t)=>e+t,0);return Math.round(a.reduce((e,t)=>e+t,0)/l)}function o(e,t,s){let r=0;return null!==t&&(r+=Math.min(8,t/2e3)),null!==e&&(r+=Math.min(8,e/12)),null!==s&&(r+=Math.min(5,s/20)),Math.round(10*Math.min(21,r))/10}let c=new class{async getToday(){await a.db.initialize();let e=await a.db.getLatestDate();if(!e)return null;let t=await a.db.getWellness(e);if(!t)return null;let s=await a.db.getHistory(90),r=s.map(e=>e.hrv?.hrv_last_night_avg??null),c=s.map(e=>e.sleep?.total_sleep_seconds?e.sleep.total_sleep_seconds/3600:null),d=s.map(e=>e.wellness?.resting_heart_rate??null),u=s.map(e=>e.stress?.body_battery_charged??null),h={hrv_7d_avg:l(r,7),hrv_30d_avg:l(r,30),hrv_90d_avg:l(r,90),sleep_7d_avg:l(c,7),sleep_30d_avg:l(c,30),sleep_90d_avg:l(c,90),rhr_7d_avg:l(d,7),rhr_30d_avg:l(d,30),rhr_90d_avg:l(d,90),recovery_7d_avg:l(u,7),recovery_90d_avg:l(u,90)},x=t.sleep?Math.round(t.sleep.total_sleep_seconds/3600*100)/100:null,p=t.hrv?.hrv_last_night_avg??null,m=t.wellness?.resting_heart_rate??null,g=t.stress?.body_battery_charged??null,y=i(p,x,g,h),f=10;if(s.length>0){let e=s[0];f=o(e.stress?.body_battery_drained??0,e.activity?.steps??0,e.activity?.intensity_minutes??0)}let v=n(p,h.hrv_7d_avg),b=function(e,t,s=7){let r=t||7.5,a=0;for(let t=0;t<Math.min(s,e.length);t++){let s=e[t];null!==s&&(a+=Math.max(0,r-s))}return Math.round(100*a)/100}(c,h.sleep_7d_avg,7),_=function(e,t,s,r,a){let n,l,i,o=e>=67?[14,21]:e>=34?[8,14]:[0,8],c=r||7.5,d=Math.max(0,c-(s||c)),u=Math.round((c+Math.max(0,(a-10)*.05)+d/7)*100)/100;if(e>=67)n="GO",l="Push hard today",i=`Recovery at ${e}% puts you in the green zone. ${"up"===t?"HRV trending up shows strong recovery.":"HRV at baseline."} Target strain ${o[0]}-${o[1]}. Great day for intervals or competition.`;else if(e>=34)n="MODERATE",l="Moderate effort today",i=`Recovery at ${e}% - yellow zone. ${"down"===t?"HRV below baseline suggests adaptation still in progress.":"Body in balanced state."} Good for steady cardio or technique work.`;else{n="RECOVER",l="Recovery focus";let t=s&&s<6?` Only ${s.toFixed(1)}h sleep is limiting recovery.`:"";i=`Recovery at ${e}% - red zone.${t} Focus on rest, hydration, and quality sleep.`}return{decision:n,headline:l,explanation:i,strain_target:o,sleep_target:u}}(y,v?.direction??null,x,h.sleep_7d_avg,f),j=this.generateWeeklySummary(s.slice(0,7),h),N=t.sleep?{total_sleep_hours:x,deep_sleep_pct:t.sleep.total_sleep_seconds>0?Math.round(t.sleep.deep_sleep_seconds/t.sleep.total_sleep_seconds*1e3)/10:0,rem_sleep_pct:t.sleep.total_sleep_seconds>0?Math.round(t.sleep.rem_sleep_seconds/t.sleep.total_sleep_seconds*1e3)/10:0,sleep_score:t.sleep.sleep_score,sleep_efficiency:t.sleep.sleep_efficiency,direction:n(x,h.sleep_7d_avg)}:null,w=t.activity?{steps:t.activity.steps,steps_goal:t.activity.steps_goal,steps_pct:t.activity.steps_goal>0?Math.round(t.activity.steps/t.activity.steps_goal*1e3)/10:0}:null;return{date:e,sleep:N,hrv:t.hrv?{hrv_last_night_avg:p,hrv_weekly_avg:t.hrv.hrv_weekly_avg,hrv_status:t.hrv.hrv_status,direction:v}:null,stress:t.stress?{avg_stress_level:t.stress.avg_stress_level,body_battery_charged:g,body_battery_drained:t.stress.body_battery_drained,direction:n(g,h.recovery_7d_avg)}:null,activity:w,resting_hr:m,rhr_direction:n(m,h.rhr_7d_avg,5,!0),baselines:h,recovery:y,insight:_,sleep_debt:b,weekly_summary:j}}generateWeeklySummary(e,t){let s=0,r=0,a=0,n=[],l=[],c=[],d=0,u={date:"",recovery:0},h={date:"",recovery:100},x=t.sleep_7d_avg||7.5;for(let p of e){let e=p.sleep?.total_sleep_seconds?p.sleep.total_sleep_seconds/3600:null,m=i(p.hrv?.hrv_last_night_avg??null,e,p.stress?.body_battery_charged??null,t);n.push(m);let g=o(p.stress?.body_battery_drained??null,p.activity?.steps??null,p.activity?.intensity_minutes??null);l.push(g),null!==e&&(c.push(e),e<x&&(d+=x-e)),m>=67?s++:m>=34?r++:a++,m>u.recovery&&(u={date:p.date,recovery:m}),m<h.recovery&&(h={date:p.date,recovery:m})}let p=n.length>0?Math.round(n.reduce((e,t)=>e+t,0)/n.length*10)/10:0,m=l.length>0?Math.round(l.reduce((e,t)=>e+t,0)/l.length*10)/10:0,g=c.length>0?Math.round(c.reduce((e,t)=>e+t,0)/c.length*100)/100:0,y=[];if(n.length>=3){let e=0;for(let t=0;t<n.length-1;t++)n[t]<n[t+1]-5&&e++;if(e>=3){let t=(n[0]-n[n.length-1])/n[n.length-1]*100;y.push({metric:"Recovery",direction:"declining",days:e,change_pct:Math.round(10*t)/10,severity:t<-20?"concern":"warning"})}}return{green_days:s,yellow_days:r,red_days:a,avg_recovery:p,avg_strain:m,avg_sleep:g,total_sleep_debt:Math.round(100*d)/100,best_day:u.date,worst_day:h.date,correlations:[],streaks:[],trend_alerts:y}}async getHistory(e=14){await a.db.initialize();let t=await a.db.getHistory(e),s=t.map(e=>e.hrv?.hrv_last_night_avg??null),r=t.map(e=>e.sleep?.total_sleep_seconds?e.sleep.total_sleep_seconds/3600:null),n={hrv_7d_avg:l(s,7),sleep_7d_avg:l(r,7)};return t.map(e=>{let t=e.sleep?.total_sleep_seconds?Math.round(e.sleep.total_sleep_seconds/3600*100)/100:null,s=i(e.hrv?.hrv_last_night_avg??null,t,e.stress?.body_battery_charged??null,n),r=o(e.stress?.body_battery_drained??null,e.activity?.steps??null,e.activity?.intensity_minutes??null),a=e.sleep?.total_sleep_seconds??0,l=a>0&&e.sleep?.deep_sleep_seconds?Math.round(e.sleep.deep_sleep_seconds/a*1e3)/10:0,c=a>0&&e.sleep?.rem_sleep_seconds?Math.round(e.sleep.rem_sleep_seconds/a*1e3)/10:0;return{date:e.date,sleep_hours:t,deep_sleep_pct:l,rem_sleep_pct:c,sleep_score:e.sleep?.sleep_score??null,sleep_efficiency:e.sleep?.sleep_efficiency??null,hrv:e.hrv?.hrv_last_night_avg??null,recovery:s,strain:r,steps:e.activity?.steps??0,steps_goal:e.activity?.steps_goal??1e4,body_battery:e.stress?.body_battery_charged??null,body_battery_drained:e.stress?.body_battery_drained??null,active_calories:e.activity?.active_calories??null,intensity_minutes:e.activity?.intensity_minutes??null,stress_avg:e.stress?.avg_stress_level??null,resting_hr:e.wellness?.resting_heart_rate??null}})}};var d=e.i(4710);function u(e,t,s=3){let r,a;switch(t){case 14:default:r=7,a="vs last week";break;case 30:r=15,a="vs last month";break;case 90:r=45,a="vs last quarter"}let n=e.slice(0,r).filter(e=>null!=e&&e>0),l=e.slice(r,2*r).filter(e=>null!=e&&e>0);if(!(n.length>=s&&l.length>=s)||0===n.length||0===l.length)return{direction:"stable",percentChange:0,currentAvg:n.length>0?n.reduce((e,t)=>e+t,0)/n.length:0,previousAvg:l.length>0?l.reduce((e,t)=>e+t,0)/l.length:0,hasEnoughData:!1,periodLabel:a};let i=n.reduce((e,t)=>e+t,0)/n.length,o=l.reduce((e,t)=>e+t,0)/l.length;if(0===o)return{direction:i>0?"up":"stable",percentChange:100*(i>0),currentAvg:i,previousAvg:o,hasEnoughData:!0,periodLabel:a};let c=(i-o)/o*100;return{direction:c>2?"up":c<-2?"down":"stable",percentChange:c,currentAvg:i,previousAvg:o,hasEnoughData:!0,periodLabel:a}}function h({info:e,onClose:s}){return(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",onClick:s,children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm"}),(0,t.jsxs)("div",{className:"relative bg-gray-900 rounded-2xl p-6 max-w-md w-full border border-gray-700 shadow-xl",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-white transition-colors text-xl",children:"×"}),(0,t.jsx)("h2",{className:"text-xl font-bold text-white mb-3",children:e.title}),(0,t.jsx)("p",{className:"text-gray-400 text-sm mb-4",children:e.description}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("h3",{className:"text-gray-500 text-xs mb-1",children:"HEALTH IMPACT"}),(0,t.jsx)("p",{className:"text-gray-300 text-sm",children:e.impact})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-gray-500 text-xs mb-2",children:"TIPS"}),(0,t.jsx)("ul",{className:"space-y-2",children:e.tips.map((e,s)=>{let r=e.startsWith("Green")?"text-green-400":e.startsWith("Yellow")?"text-yellow-400":e.startsWith("Red")?"text-red-400":"text-teal-400";return(0,t.jsxs)("li",{className:"text-gray-400 text-sm flex gap-2",children:[(0,t.jsx)("span",{className:r,children:"•"}),(0,t.jsx)("span",{children:e})]},s)})})]})]})]})}function x({onClick:e}){return(0,t.jsx)("button",{onClick:t=>{t.stopPropagation(),e()},className:"w-5 h-5 rounded-full bg-gray-700 hover:bg-gray-600 text-gray-400 hover:text-white text-xs flex items-center justify-center transition-colors","aria-label":"More info",children:"?"})}e.i(82568);let p={recovery:{title:"Recovery Score",description:"Your recovery score (0-100%) measures how ready your body is to perform today. It combines HRV, sleep quality, and body battery to estimate your physiological readiness.",impact:"Higher recovery means your nervous system is balanced and your body has restored energy. Low recovery suggests accumulated stress or insufficient rest.",tips:["Green (67-100%): Push hard - ideal for intense workouts","Yellow (34-66%): Moderate effort - technique work or steady cardio","Red (0-33%): Recovery focus - rest, mobility, light yoga"]},strain:{title:"Strain Score",description:"Strain (0-21) measures the cardiovascular load on your body throughout the day. It combines steps, intensity minutes, and energy expenditure.",impact:"The scale is logarithmic - going from 18 to 19 is much harder than 5 to 6. This prevents overtraining by making high strain harder to achieve.",tips:["Match strain to recovery for optimal adaptation","Higher recovery days = higher strain targets","Consistent moderate strain beats occasional extreme strain"]},sleep:{title:"Sleep",description:"Sleep duration and quality are crucial for recovery. We track total hours, sleep stages (deep, REM, light), and efficiency (time asleep vs time in bed).",impact:"Deep sleep restores physical energy and repairs muscles. REM sleep consolidates memory and regulates mood. Both are essential for full recovery.",tips:["Aim for your personal baseline, not a fixed 8 hours","Higher strain days require more sleep","Consistency matters more than occasional long sleeps"]},hrv:{title:"Heart Rate Variability (HRV)",description:"HRV measures the variation in time between heartbeats (in milliseconds). Higher HRV generally indicates better cardiovascular fitness and recovery.",impact:"HRV reflects your autonomic nervous system balance. High HRV = parasympathetic (rest) dominant. Low HRV = sympathetic (stress) dominant.",tips:["Compare to YOUR baseline, not population averages","Sudden drops may indicate stress, illness, or overtraining","HRV naturally varies - look at 7-day trends"]},rhr:{title:"Resting Heart Rate (RHR)",description:"Your resting heart rate is measured during sleep. Lower RHR generally indicates better cardiovascular fitness and recovery.",impact:"Elevated RHR (above your baseline) can signal stress, dehydration, illness, or overtraining. It's an early warning system for your body.",tips:["Lower is generally better for RHR","A spike of 5+ bpm above baseline warrants attention","Alcohol, late meals, and stress all elevate RHR"]},body_battery:{title:"Body Battery",description:"Body Battery (0-100) tracks your energy levels throughout the day. It charges during rest and sleep, and drains during activity and stress.",impact:"High morning body battery indicates good overnight recovery. Tracking drain rate helps understand how activities affect your energy.",tips:["Aim to start the day with 60+ body battery","High stress drains battery even without physical activity","Matches well with subjective energy feelings"]},sleep_stages:{title:"Sleep Stages",description:"Sleep cycles through stages: Light (N1/N2), Deep (N3), and REM. Each serves different recovery functions.",impact:"Deep sleep (15-20%): Physical restoration, muscle repair, immune function. REM (20-25%): Mental recovery, memory consolidation, emotional regulation.",tips:["Alcohol suppresses REM sleep","Late exercise can reduce deep sleep","Cool room temperature promotes better deep sleep"]},sleep_debt:{title:"Sleep Debt",description:"Sleep debt accumulates when you sleep less than your body needs. It represents the total hours of missed sleep over recent days.",impact:"Accumulated sleep debt impairs cognitive function, mood, and physical recovery. It takes multiple nights of good sleep to fully repay.",tips:["Spread debt repayment over several nights","Add 10-15 mins per night to gradually repay","Sleeping in on weekends doesn't fully repay weekday debt"]}};function m(e){let t=[],s=[];if(e.hrv?.value&&e.baselines?.hrv_7d_avg){let r=Math.min(100,Math.max(0,80*(e.hrv.value/e.baselines.hrv_7d_avg)+20));s.push(1.5*r),t.push(1.5)}else if(e.hrv?.value&&e.hrv?.baseline){let r=Math.min(100,Math.max(0,75*(e.hrv.value/e.hrv.baseline)+25));s.push(1.5*r),t.push(1.5)}if(e.sleep?.total_hours&&e.baselines?.sleep_7d_avg){let r=Math.min(100,Math.max(0,85*(e.sleep.total_hours/e.baselines.sleep_7d_avg)+15));s.push(r),t.push(1)}else if(e.sleep){let r=Math.min(100,e.sleep.total_hours/8*85+e.sleep.deep_pct/20*15);s.push(r),t.push(1)}if(e.strain?.body_battery_charged&&(s.push(e.strain.body_battery_charged),t.push(1)),0===s.length)return 0;let r=t.reduce((e,t)=>e+t,0);return Math.round(s.reduce((e,t)=>e+t,0)/r)}function g(e){let t=0;return e.activity?.steps&&(t+=Math.min(8,e.activity.steps/2e3)),e.strain?.body_battery_drained&&(t+=Math.min(8,e.strain.body_battery_drained/12)),e.strain?.intensity_minutes&&(t+=Math.min(5,e.strain.intensity_minutes/20)),Math.round(10*Math.min(21,t))/10}function y(e){return e>=67?"#00F19B":e>=34?"#FFCC00":"#FF4D4D"}function f(e){return e>=67?[14,21]:e>=34?[8,14]:[0,8]}function v(e){let t=Math.floor(e),s=Math.round((e-t)*60);return`${t}h ${s.toString().padStart(2,"0")}m`}function b({color:e,count:s,label:r}){return(0,t.jsxs)("div",{className:`flex-1 px-3 py-2 rounded-lg border ${{green:"bg-green-900/40 border-green-700",yellow:"bg-yellow-900/40 border-yellow-700",red:"bg-red-900/40 border-red-700"}[e]}`,children:[(0,t.jsx)("div",{className:`text-xl font-bold ${{green:"text-green-400",yellow:"text-yellow-400",red:"text-red-400"}[e]}`,children:s}),(0,t.jsx)("div",{className:"text-gray-500 text-xs",children:r})]})}function _({trend:e,inverse:s=!1,className:r=""}){let a=function(e,t=!1){if(!e.hasEnoughData||"stable"===e.direction)return null;let s=Math.abs(e.percentChange),r="up"===e.direction?"↑":"↓";return{text:`${r} ${s.toFixed(0)}% ${e.periodLabel}`,colorClass:(t?"down"===e.direction:"up"===e.direction)?"text-green-400":"text-red-400",arrow:r}}(e,s);return a?(0,t.jsx)("div",{className:`text-xs ${a.colorClass} ${r}`,children:a.text}):!e.hasEnoughData&&e.currentAvg>0?(0,t.jsx)("div",{className:`text-xs text-gray-500 ${r}`,children:"-- vs last week"}):null}function j({history:e,weeklySummary:s}){let r=e.slice(0,7),a=s?.green_days??r.filter(e=>m(e)>=67).length,n=s?.yellow_days??r.filter(e=>{let t=m(e);return t>=34&&t<67}).length,l=s?.red_days??r.filter(e=>34>m(e)).length,i=r.map(e=>m(e)),o=s?.avg_recovery??(i.length>0?Math.round(i.reduce((e,t)=>e+t,0)/i.length):0),c=e.slice(7,14).map(e=>m(e)),d=c.length>0?Math.round(c.reduce((e,t)=>e+t,0)/c.length):o,u=o-d,h=s?.correlations||[],x=s?.streaks||[],p=s?.trend_alerts||[],g=h.length>0?h[0]:null;return(0,t.jsxs)("div",{className:"bg-gray-900 rounded-2xl p-4 space-y-4",children:[(0,t.jsx)("div",{className:"text-gray-500 text-xs",children:"THIS WEEK"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(b,{color:"green",count:a,label:"Green"}),(0,t.jsx)(b,{color:"yellow",count:n,label:"Yellow"}),(0,t.jsx)(b,{color:"red",count:l,label:"Red"})]}),0!==u&&(0,t.jsxs)("div",{className:`text-sm ${u>0?"text-green-400":"text-red-400"}`,children:[u>0?"+":"",u.toFixed(1),"% recovery vs last week"]}),x.length>0&&(0,t.jsx)("div",{className:"space-y-2",children:x.slice(0,3).map((e,s)=>{let{icon:r,label:a}=function(e){switch(e.name){case"green_days":return{icon:"!",label:`${e.current_count}-day green streak`};case"sleep_consistency":return{icon:"~",label:`${e.current_count} days of 7h+ sleep`};case"step_goal":return{icon:"#",label:`${e.current_count} days hitting step goal`};default:return{icon:"*",label:`${e.current_count}-day streak`}}}(e);return(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,t.jsx)("span",{className:"text-orange-400 font-bold",children:r}),(0,t.jsx)("span",{className:"text-gray-300",children:a}),e.current_count>=e.best_count&&e.best_count>0&&(0,t.jsx)("span",{className:"text-yellow-400 text-xs",children:"(Personal best!)"})]},s)})}),p.length>0&&(0,t.jsx)("div",{className:"space-y-2 pt-2 border-t border-gray-800",children:p.map((e,s)=>(0,t.jsxs)("div",{className:`flex items-start gap-2 text-sm ${"positive"===e.severity?"text-green-400":"concern"===e.severity?"text-red-400":"text-yellow-400"}`,children:[(0,t.jsx)("span",{children:"positive"===e.severity?"^":"!"}),(0,t.jsxs)("span",{children:[e.metric," ",e.direction," for ",e.days," days (",e.change_pct>0?"+":"",e.change_pct.toFixed(0),"%)"]})]},s))}),g&&(0,t.jsxs)("div",{className:`border-l-2 pl-3 ${"negative"===g.pattern_type?"border-yellow-400":"border-green-400"}`,children:[(0,t.jsx)("div",{className:`text-sm font-medium ${"negative"===g.pattern_type?"text-yellow-400":"text-green-400"}`,children:"Pattern Detected"}),(0,t.jsx)("div",{className:"text-gray-400 text-sm",children:g.description}),g.confidence>=.7&&(0,t.jsxs)("div",{className:"text-gray-600 text-xs mt-1",children:["Based on ",g.sample_size," data points"]})]})]})}function N({value:e,onChange:s}){return(0,t.jsx)("div",{className:"inline-flex rounded-full bg-gray-800 p-0.5 text-xs",children:[14,30,90].map(r=>(0,t.jsxs)("button",{onClick:()=>s(r),className:`px-2.5 py-1 rounded-full transition-all ${e===r?"bg-gray-700 text-white":"text-gray-400 hover:text-gray-300"}`,children:[r,"D"]},r))})}function w({value:e,onChange:s}){return(0,t.jsx)("div",{className:"inline-flex rounded-md bg-gray-800/50 p-0.5 text-[10px]",children:[7,14,30].map(r=>(0,t.jsxs)("button",{onClick:()=>s(r),className:`px-1.5 py-0.5 rounded transition-all ${e===r?"bg-gray-700 text-white":"text-gray-500 hover:text-gray-400"}`,children:[r,"D"]},r))})}function S(){let[e,n]=(0,s.useState)(14),[l,i]=(0,s.useState)(7),{history:o,loading:u,error:x}=function(e=14){let[t,r]=(0,s.useState)([]),[n,l]=(0,s.useState)(!0),[i,o]=(0,s.useState)(null);return(0,s.useEffect)(()=>{!async function(){try{await a.db.initialize();let t=(await c.getHistory(e)).map(e=>({date:e.date,sleep:e.sleep_hours?{total_hours:e.sleep_hours,deep_pct:e.deep_sleep_pct,rem_pct:e.rem_sleep_pct,score:e.sleep_score,efficiency:e.sleep_efficiency,direction:null}:null,hrv:{value:e.hrv,baseline:null,status:null,direction:null},strain:{body_battery_charged:e.body_battery,body_battery_drained:e.body_battery_drained,stress_avg:e.stress_avg,active_calories:e.active_calories,intensity_minutes:e.intensity_minutes,direction:null},activity:{steps:e.steps,steps_goal:e.steps_goal},resting_hr:e.resting_hr,rhr_direction:null,recovery:e.recovery}));r(t)}catch(e){console.error("Failed to load wellness history:",e),o(e instanceof Error?e.message:"Failed to load data")}finally{l(!1)}}()},[e]),{history:t,loading:n,error:i}}(90),f=function(){let[e,t]=(0,s.useState)(null),[r,a]=(0,s.useState)(!1),[n,l]=(0,s.useState)(null),[i,o]=(0,s.useState)(null);(0,s.useEffect)(()=>{!async function(){t(await d.garmin.isAuthenticated())}()},[]);let c=async(t=7)=>{if(!e)return o("Not authenticated"),!1;a(!0),l({current:0,total:t}),o(null);try{let e=await d.garmin.syncViaBackend(t,(e,t)=>{l({current:e,total:t})});if(!e.success)return o(e.error||"Sync failed"),!1;return!0}catch(e){return o(e instanceof Error?e.message:"Sync failed"),!1}finally{a(!1),l(null)}};return{isAuthenticated:e,syncing:r,progress:n,error:i,login:async(e,s)=>{o(null);let r=await d.garmin.login(e,s);return r.success?(t(!0),!0):(o(r.error||"Login failed"),!1)},logout:async()=>{await d.garmin.logout(),t(!1)},sync:c}}(),[v,b]=(0,s.useState)("overview"),[_,j]=(0,s.useState)(null),[N,w]=(0,s.useState)(14),[S,E]=(0,s.useState)(null),$=(0,s.useMemo)(()=>S&&o.find(e=>e.date===S)||(o.length>0?o[0]:null),[o,S]),P=e=>{E(e.date)};if(u)return(0,t.jsx)("div",{className:"min-h-screen bg-black flex items-center justify-center",children:(0,t.jsx)("div",{className:"w-8 h-8 border-2 border-gray-700 border-t-white rounded-full animate-spin"})});if(!$)return(0,t.jsxs)("div",{className:"min-h-screen bg-black flex flex-col items-center justify-center gap-6 text-gray-400 p-6",children:[(0,t.jsx)("div",{className:"w-20 h-20 rounded-full bg-gradient-to-br from-teal-400 to-blue-500 flex items-center justify-center text-3xl font-bold text-white",children:"W"}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h1",{className:"text-white text-xl font-semibold mb-2",children:"Welcome to WHOOP Dashboard"}),(0,t.jsx)("p",{className:"text-gray-500 text-sm max-w-xs",children:"Connect your Garmin account to sync your wellness data and start tracking your recovery."})]}),(0,t.jsxs)(r.default,{href:"/sync",className:"flex items-center gap-2 bg-teal-500 hover:bg-teal-400 text-black font-semibold px-6 py-3 rounded-full transition-colors",children:[(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Sync with Garmin"]})]});let A=m($),T=g($),D=y(A),O=o.slice(0,l),F=O.length>0?Math.round(O.reduce((e,t)=>e+m(t),0)/O.length):0,L=O.length>0?Math.round(O.reduce((e,t)=>e+g(t),0)/O.length*10)/10:0,H=O.length>0?Math.round(O.reduce((e,t)=>e+(t.sleep?.total_hours||0),0)/O.length*10)/10:0;return(0,t.jsxs)("div",{className:"min-h-screen bg-black text-white",children:[(0,t.jsxs)("nav",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-900",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-teal-400 to-blue-500 flex items-center justify-center text-xs font-bold",children:"W"}),(0,t.jsx)("span",{className:"font-semibold tracking-tight",children:"DASHBOARD"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)(r.default,{href:"/sync",className:"flex items-center gap-1.5 text-gray-400 hover:text-teal-400 transition-colors text-sm",children:[(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Sync"})]}),(0,t.jsx)("div",{className:"text-gray-500 text-sm",children:new Date($.date).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]})]}),(0,t.jsx)("div",{className:"flex border-b border-gray-900",children:["overview","recovery","strain","sleep"].map(e=>(0,t.jsx)("button",{onClick:()=>b(e),className:`flex-1 py-3 text-sm font-medium transition-colors ${v===e?"text-white border-b-2 border-white":"text-gray-600 hover:text-gray-400"}`,children:e.toUpperCase()},e))}),(0,t.jsxs)("main",{className:"max-w-lg mx-auto",children:["overview"===v&&(0,t.jsx)(k,{selectedDay:$,history:o,recovery:A,strain:T,recoveryColor:D,avgRecovery:F,avgStrain:L,avgSleep:H,overviewPeriod:l,onOverviewPeriodChange:i,onSelectDay:P,onShowInfo:j,garminSync:f,syncDays:N,onSyncDaysChange:w}),"recovery"===v&&(0,t.jsx)(M,{selectedDay:$,history:o,recovery:A,recoveryColor:D,onSelectDay:P,onShowInfo:j,trendPeriod:e,onTrendPeriodChange:n}),"strain"===v&&(0,t.jsx)(R,{selectedDay:$,history:o,strain:T,onSelectDay:P,onShowInfo:j,trendPeriod:e,onTrendPeriodChange:n}),"sleep"===v&&(0,t.jsx)(C,{selectedDay:$,history:o,onSelectDay:P,onShowInfo:j,trendPeriod:e,onTrendPeriodChange:n})]}),_&&p[_]&&(0,t.jsx)(h,{info:p[_],onClose:()=>j(null)})]})}function k({selectedDay:e,history:r,recovery:a,strain:n,recoveryColor:l,avgRecovery:i,avgStrain:o,avgSleep:c,overviewPeriod:d,onOverviewPeriodChange:u,onSelectDay:h,onShowInfo:p,garminSync:g,syncDays:v,onSyncDaysChange:b}){let _=f(a),[N,S]=(0,s.useState)(!1),[k,M]=(0,s.useState)(""),[R,C]=(0,s.useState)(""),[E,P]=(0,s.useState)(null),A=async()=>{P(null),await g.login(k,R)?(S(!1),g.sync(v)):P(g.error||"Login failed")},T=async()=>{g.isAuthenticated?(await g.sync(v),window.location.reload()):S(!0)};return(0,t.jsxs)("div",{className:"p-4 space-y-6",children:[(0,t.jsxs)("div",{className:"text-center py-6 bg-gradient-to-b from-gray-900 to-black rounded-2xl",children:[(0,t.jsx)("div",{className:`text-5xl sm:text-6xl font-bold mb-3 ${a>=67?"text-green-400":a>=34?"text-yellow-400":"text-red-400"}`,children:a>=67?"GO FOR IT":a>=34?"MODERATE":"RECOVER"}),(0,t.jsx)("p",{className:"text-gray-400 text-base max-w-xs mx-auto px-4",children:function(e,t){if(e>=67){let e=t.hrv?.direction?.direction==="up"?"HRV trending up":"HRV at baseline";return`Your body is primed for intensity. ${e}. Push hard today.`}if(e>=34)return"Your body can handle moderate effort. Avoid all-out intensity.";let s=t.sleep&&t.sleep.total_hours<6?` Only ${t.sleep.total_hours.toFixed(1)}h sleep is limiting you.`:"";return`Focus on recovery today.${s} Light movement is fine.`}(a,e)}),(0,t.jsxs)("div",{className:"mt-4 flex items-center justify-center gap-4 text-sm",children:[(0,t.jsxs)("div",{className:"text-gray-500",children:["Target strain: ",(0,t.jsxs)("span",{className:"text-white font-medium",children:[_[0],"-",_[1]]})]}),(0,t.jsx)("div",{className:"w-px h-4 bg-gray-700"}),(0,t.jsx)("div",{className:"text-gray-500",children:a>=67?"Great day for intervals or racing":a>=34?"Steady cardio or technique work":"Rest, mobility, light yoga"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between px-1",children:[(0,t.jsxs)("div",{className:"text-gray-500 text-xs",children:[d,"-DAY AVERAGES"]}),(0,t.jsx)(w,{value:d,onChange:u})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,t.jsxs)("div",{className:"bg-gray-900 rounded-xl p-3 text-center",children:[(0,t.jsx)("div",{className:"text-gray-500 text-xs mb-1",children:"RECOVERY"}),(0,t.jsxs)("div",{className:"text-xl font-bold",style:{color:y(i)},children:[i,"%"]})]}),(0,t.jsxs)("div",{className:"bg-gray-900 rounded-xl p-3 text-center",children:[(0,t.jsx)("div",{className:"text-gray-500 text-xs mb-1",children:"STRAIN"}),(0,t.jsx)("div",{className:"text-xl font-bold text-blue-400",children:o})]}),(0,t.jsxs)("div",{className:"bg-gray-900 rounded-xl p-3 text-center",children:[(0,t.jsx)("div",{className:"text-gray-500 text-xs mb-1",children:"SLEEP"}),(0,t.jsxs)("div",{className:"text-xl font-bold text-purple-400",children:[c,"h"]})]})]})]}),(0,t.jsx)("div",{className:"flex gap-1 overflow-x-auto pb-2 -mx-4 px-4 scrollbar-hide",children:r.map(s=>{let r=m(s),a=s.date===e.date;return(0,t.jsxs)("button",{onClick:()=>h(s),className:`flex-shrink-0 w-12 py-2 rounded-lg transition-all ${a?"bg-gray-800 ring-1 ring-gray-600":"hover:bg-gray-900"}`,children:[(0,t.jsx)("div",{className:"text-gray-500 text-[10px]",children:new Date(s.date).toLocaleDateString("en-US",{weekday:"short"}).toUpperCase()}),(0,t.jsx)("div",{className:"text-xs font-medium mt-0.5",children:new Date(s.date).getDate()}),(0,t.jsx)("div",{className:"w-2 h-2 rounded-full mx-auto mt-1",style:{backgroundColor:y(r)}})]},s.date)})}),(0,t.jsxs)("div",{className:"flex flex-col items-center py-4",children:[(0,t.jsxs)("div",{className:"relative w-52 h-52",children:[(0,t.jsx)("div",{className:"absolute top-0 right-0 z-10",children:(0,t.jsx)(x,{onClick:()=>p("recovery")})}),(0,t.jsxs)("svg",{className:"w-full h-full transform -rotate-90",children:[(0,t.jsx)("circle",{cx:"104",cy:"104",r:"92",fill:"none",stroke:"#1a1a1a",strokeWidth:"16"}),(0,t.jsx)("circle",{cx:"104",cy:"104",r:"92",fill:"none",stroke:l,strokeWidth:"16",strokeLinecap:"round",strokeDasharray:`${5.78*a} 578`,className:"transition-all duration-700"})]}),(0,t.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[(0,t.jsxs)("span",{className:"text-6xl font-bold",style:{color:l},children:[a,"%"]}),(0,t.jsx)("span",{className:"text-gray-500 text-sm mt-1",children:"RECOVERY"})]})]}),(0,t.jsxs)("div",{className:"mt-4 px-5 py-2 rounded-full text-sm font-semibold",style:{backgroundColor:l+"20",color:l},children:[a>=67?"GREEN":a>=34?"YELLOW":"RED"," ZONE"]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsx)($,{label:"STRAIN",value:n.toString(),unit:"of 21",color:"#3B82F6",progress:n/21,infoKey:"strain",onShowInfo:p}),(0,t.jsx)($,{label:"SLEEP",value:e.sleep?.total_hours.toFixed(1)||"--",unit:"hours",color:"#A855F7",progress:(e.sleep?.total_hours||0)/(e.baselines?.sleep_7d_avg||8),direction:e.sleep?.direction,baselineLabel:"vs your avg",infoKey:"sleep",onShowInfo:p}),(0,t.jsx)($,{label:"HRV",value:e.hrv?.value?.toString()||"--",unit:"ms",color:"#10B981",direction:e.hrv?.direction,baselineLabel:"vs your avg",infoKey:"hrv",onShowInfo:p}),(0,t.jsx)($,{label:"RHR",value:e.resting_hr?.toString()||"--",unit:"bpm",color:"#EF4444",direction:e.rhr_direction,baselineLabel:"vs your avg",infoKey:"rhr",onShowInfo:p})]}),(0,t.jsxs)("div",{className:"bg-gradient-to-br from-gray-900 to-gray-950 rounded-2xl p-4 border border-gray-800",children:[(0,t.jsx)("div",{className:"text-gray-500 text-xs mb-2",children:"INSIGHT"}),(0,t.jsx)("p",{className:"text-gray-300 text-sm leading-relaxed",children:a>=67?(0,t.jsxs)(t.Fragment,{children:["Your body is primed for peak performance. HRV is ",e.hrv?.value&&e.hrv?.baseline&&e.hrv.value>=e.hrv.baseline?"above":"near"," baseline. Consider a high-intensity workout or competition."]}):a>=34?(0,t.jsx)(t.Fragment,{children:"Moderate recovery detected. Your body can handle activity but avoid overexertion. Focus on technique work or moderate cardio."}):(0,t.jsx)(t.Fragment,{children:"Recovery is low. Prioritize rest, hydration, and sleep quality tonight. Light stretching or yoga recommended."})})]}),(0,t.jsx)(j,{history:r,weeklySummary:e.weekly_summary}),(0,t.jsxs)("div",{className:"bg-gradient-to-br from-teal-900/30 to-gray-900 rounded-2xl p-4 border border-teal-800/30",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,t.jsx)("div",{className:"text-gray-400 text-xs font-medium",children:"GARMIN SYNC"}),g.isAuthenticated&&(0,t.jsx)("button",{onClick:()=>g.logout(),className:"text-xs text-gray-500 hover:text-gray-300",children:"Logout"})]}),N?(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("input",{type:"email",placeholder:"Garmin Email",value:k,onChange:e=>M(e.target.value),className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-sm text-white placeholder-gray-500 focus:outline-none focus:border-teal-500"}),(0,t.jsx)("input",{type:"password",placeholder:"Password",value:R,onChange:e=>C(e.target.value),className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-sm text-white placeholder-gray-500 focus:outline-none focus:border-teal-500"}),E&&(0,t.jsx)("div",{className:"text-red-400 text-xs",children:E}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:A,className:"flex-1 bg-teal-500 hover:bg-teal-400 text-black font-semibold py-2 rounded-lg text-sm transition-colors",children:"Login & Sync"}),(0,t.jsx)("button",{onClick:()=>S(!1),className:"px-4 bg-gray-700 hover:bg-gray-600 text-white py-2 rounded-lg text-sm transition-colors",children:"Cancel"})]})]}):(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("select",{value:v,onChange:e=>b(Number(e.target.value)),className:"bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:border-teal-500",children:[(0,t.jsx)("option",{value:7,children:"7 days"}),(0,t.jsx)("option",{value:14,children:"14 days"}),(0,t.jsx)("option",{value:30,children:"30 days"}),(0,t.jsx)("option",{value:60,children:"60 days"}),(0,t.jsx)("option",{value:90,children:"90 days"})]}),(0,t.jsx)("button",{onClick:T,disabled:g.syncing,className:"flex-1 bg-teal-500 hover:bg-teal-400 disabled:bg-teal-700 disabled:cursor-not-allowed text-black font-semibold py-2 rounded-lg text-sm transition-colors flex items-center justify-center gap-2",children:g.syncing?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"w-4 h-4 border-2 border-black/30 border-t-black rounded-full animate-spin"}),g.progress?`${g.progress.current}/${g.progress.total}`:"Syncing..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),g.isAuthenticated?"Sync Now":"Connect Garmin"]})})]}),g.error&&(0,t.jsx)("div",{className:"text-red-400 text-xs",children:g.error}),g.isAuthenticated&&(0,t.jsx)("div",{className:"text-gray-500 text-xs text-center",children:"Connected to Garmin Connect"})]})]})]})}function M({selectedDay:e,history:r,recovery:a,recoveryColor:n,onSelectDay:l,onShowInfo:i,trendPeriod:o,onTrendPeriodChange:c}){let d=r.slice(0,o),h=d.map(e=>m(e)).reverse(),p=Math.max(...h,100),g=(0,s.useMemo)(()=>r.map(e=>m(e)),[r]),f=(0,s.useMemo)(()=>u(g,o),[g,o]);return(0,t.jsxs)("div",{className:"p-4 space-y-6",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center py-4",children:[(0,t.jsxs)("div",{className:"relative w-44 h-44",children:[(0,t.jsx)("div",{className:"absolute top-0 right-0 z-10",children:(0,t.jsx)(x,{onClick:()=>i("recovery")})}),(0,t.jsxs)("svg",{className:"w-full h-full transform -rotate-90",children:[(0,t.jsx)("circle",{cx:"88",cy:"88",r:"76",fill:"none",stroke:"#1a1a1a",strokeWidth:"14"}),(0,t.jsx)("circle",{cx:"88",cy:"88",r:"76",fill:"none",stroke:n,strokeWidth:"14",strokeLinecap:"round",strokeDasharray:`${4.77*a} 477`,className:"transition-all duration-700"})]}),(0,t.jsx)("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:(0,t.jsxs)("span",{className:"text-5xl font-bold",style:{color:n},children:[a,"%"]})})]}),(0,t.jsx)("div",{className:"text-gray-500 text-sm mt-2",children:new Date(e.date).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})}),(0,t.jsx)(_,{trend:f,className:"mt-1"})]}),(0,t.jsxs)("div",{className:"bg-gray-900 rounded-2xl p-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsxs)("div",{className:"text-gray-500 text-xs",children:[o,"-DAY TREND"]}),(0,t.jsx)(N,{value:o,onChange:c})]}),(0,t.jsx)("div",{className:"h-32 flex items-end gap-0.5 overflow-x-auto",children:h.map((s,r)=>{let a=d[d.length-1-r],n=a?.date===e.date,i=o<=14?"flex-1":o<=30?"min-w-[8px] flex-shrink-0":"min-w-[4px] flex-shrink-0";return(0,t.jsx)("button",{onClick:()=>a&&l(a),className:`${i} rounded-t transition-all ${n?"ring-1 ring-white":""}`,style:{height:`${s/p*100}%`,backgroundColor:y(s),minHeight:"4px"}},r)})}),(0,t.jsxs)("div",{className:"flex justify-between mt-2 text-[10px] text-gray-600",children:[(0,t.jsx)("span",{children:d[d.length-1]?.date.slice(5)}),(0,t.jsx)("span",{children:"Today"})]})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("div",{className:"text-gray-500 text-xs",children:"CONTRIBUTING FACTORS (vs your baselines)"}),(0,t.jsx)(P,{label:"HRV",value:e.hrv?.value,baseline:e.baselines?.hrv_7d_avg||e.hrv?.baseline,unit:"ms",direction:e.hrv?.direction}),(0,t.jsx)(P,{label:"Sleep",value:e.sleep?.total_hours,baseline:e.baselines?.sleep_7d_avg,unit:"h",direction:e.sleep?.direction}),(0,t.jsx)(P,{label:"Body Battery Charged",value:e.strain?.body_battery_charged,baseline:e.baselines?.recovery_7d_avg,unit:"",direction:e.strain?.direction}),(0,t.jsx)(P,{label:"Resting Heart Rate",value:e.resting_hr,baseline:e.baselines?.rhr_7d_avg,unit:"bpm",direction:e.rhr_direction,inverse:!0})]})]})}function R({selectedDay:e,history:r,strain:a,onSelectDay:n,onShowInfo:l,trendPeriod:i,onTrendPeriodChange:o}){let c=r.slice(0,i),d=c.map(e=>g(e)).reverse(),h=Math.max(...d,21),p=f(m(e)),y=a>=p[0]&&a<=p[1],v=a<p[0],b=a>p[1],j=(0,s.useMemo)(()=>r.map(e=>g(e)),[r]),w=(0,s.useMemo)(()=>u(j,i),[j,i]);return(0,t.jsxs)("div",{className:"p-4 space-y-6",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center py-4 relative",children:[(0,t.jsx)("div",{className:"absolute top-4 right-4",children:(0,t.jsx)(x,{onClick:()=>l("strain")})}),(0,t.jsx)("div",{className:"text-7xl font-bold text-blue-400",children:a}),(0,t.jsx)("div",{className:"text-gray-500 text-sm",children:"of 21.0 max strain"}),(0,t.jsx)(_,{trend:w,className:"mt-1"}),(0,t.jsxs)("div",{className:"w-full max-w-xs mt-6 relative",children:[(0,t.jsx)("div",{className:"absolute h-5 bg-gray-700/50 rounded-sm -top-1",style:{left:`${p[0]/21*100}%`,width:`${(p[1]-p[0])/21*100}%`}}),(0,t.jsx)("div",{className:"h-3 bg-gray-800 rounded-full overflow-hidden relative z-10",children:(0,t.jsx)("div",{className:`h-full rounded-full transition-all duration-500 ${y?"bg-gradient-to-r from-green-600 to-green-400":b?"bg-gradient-to-r from-red-600 to-red-400":"bg-gradient-to-r from-blue-600 to-blue-400"}`,style:{width:`${a/21*100}%`}})})]}),(0,t.jsxs)("div",{className:"flex justify-between w-full max-w-xs mt-1 text-[10px] text-gray-600",children:[(0,t.jsx)("span",{children:"Light"}),(0,t.jsx)("span",{children:"Moderate"}),(0,t.jsx)("span",{children:"High"}),(0,t.jsx)("span",{children:"All Out"})]}),(0,t.jsx)("div",{className:`mt-4 px-4 py-2 rounded-lg text-sm ${y?"bg-green-900/30 text-green-400":v?"bg-gray-800 text-gray-400":"bg-red-900/30 text-red-400"}`,children:y?(0,t.jsxs)(t.Fragment,{children:["In target zone (",p[0],"-",p[1],")"]}):v?(0,t.jsxs)(t.Fragment,{children:["Target: ",p[0],"-",p[1]," | ",(p[0]-a).toFixed(1)," more to go"]}):(0,t.jsxs)(t.Fragment,{children:["Above target (",p[0],"-",p[1],") - Consider recovery"]})})]}),(0,t.jsxs)("div",{className:"bg-gray-900 rounded-2xl p-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsxs)("div",{className:"text-gray-500 text-xs",children:[i,"-DAY STRAIN"]}),(0,t.jsx)(N,{value:i,onChange:o})]}),(0,t.jsx)("div",{className:"h-28 flex items-end gap-0.5 overflow-x-auto",children:d.map((s,r)=>{let a=c[c.length-1-r],l=a?.date===e.date,o=i<=14?"flex-1":i<=30?"min-w-[8px] flex-shrink-0":"min-w-[4px] flex-shrink-0";return(0,t.jsx)("button",{onClick:()=>a&&n(a),className:`${o} rounded-t transition-all ${l?"ring-1 ring-white":""}`,style:{height:`${s/h*100}%`,backgroundColor:"#3B82F6",minHeight:"4px"}},r)})})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("div",{className:"text-gray-500 text-xs",children:"STRAIN BREAKDOWN"}),(0,t.jsxs)("div",{className:"bg-gray-900 rounded-xl p-4 space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-400",children:"Steps"}),(0,t.jsx)("span",{className:"font-medium",children:e.activity?.steps.toLocaleString()||0})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-400",children:"Active Calories"}),(0,t.jsxs)("span",{className:"font-medium",children:[e.strain?.active_calories||"--"," kcal"]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-400",children:"Intensity Minutes"}),(0,t.jsxs)("span",{className:"font-medium",children:[e.strain?.intensity_minutes||0," min"]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-400",children:"Energy Drained"}),(0,t.jsx)("span",{className:"font-medium",children:e.strain?.body_battery_drained||"--"})]})]})]})]})}function C({selectedDay:e,history:r,onSelectDay:a,onShowInfo:n,trendPeriod:l,onTrendPeriodChange:i}){let o=e.sleep,c=r.slice(0,l),d=c.map(e=>e.sleep?.total_hours||0).reverse(),h=Math.max(...d,10),p=(0,s.useMemo)(()=>r.map(e=>e.sleep?.total_hours||0),[r]),m=(0,s.useMemo)(()=>u(p,l),[p,l]),y=e.baselines?.sleep_7d_avg||7.5,f=r[1]?g(r[1]):10,b=r.slice(0,7).reduce((e,t)=>e+Math.max(0,(t.baselines?.sleep_7d_avg||y)-(t.sleep?.total_hours||0)),0),j=Math.round((y+Math.max(0,(f-10)*.05)+Math.max(0,b)/7)*100)/100,w=Math.round(60*Math.max(0,(f-10)*.05)),S=Math.round(Math.max(0,b)/7*60);return(0,t.jsxs)("div",{className:"p-4 space-y-6",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center py-4",children:[(0,t.jsxs)("div",{className:"flex items-baseline",children:[(0,t.jsx)("div",{className:"text-6xl font-bold text-purple-400",children:o?.total_hours.toFixed(1)||"--"}),(0,t.jsx)("span",{className:"text-2xl font-normal text-gray-500 ml-1",children:"hrs"}),o?.direction&&"stable"!==o.direction.direction&&(0,t.jsxs)("span",{className:`text-lg ml-2 ${"up"===o.direction.direction?"text-green-400":"text-red-400"}`,children:["up"===o.direction.direction?"+":"",o.direction.change_pct.toFixed(0),"%"]})]}),(0,t.jsx)("div",{className:"text-gray-500 text-sm mt-1",children:o?.efficiency?`${o.efficiency.toFixed(0)}% efficiency`:"No sleep data"}),e.baselines?.sleep_7d_avg&&(0,t.jsxs)("div",{className:"text-gray-600 text-xs mt-1",children:["Your avg: ",e.baselines.sleep_7d_avg.toFixed(1),"h"]}),(0,t.jsx)(_,{trend:m,className:"mt-1"})]}),(0,t.jsxs)("div",{className:"bg-gradient-to-br from-purple-900/40 to-gray-900 rounded-2xl p-4 border border-purple-800/30 relative",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,t.jsx)("div",{className:"text-gray-400 text-xs",children:"TONIGHT'S TARGET"}),(0,t.jsx)(x,{onClick:()=>n("sleep_debt")})]}),(0,t.jsx)("div",{className:"flex items-baseline justify-center mb-4",children:(0,t.jsx)("span",{className:"text-4xl font-bold text-purple-400",children:v(j)})}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between text-gray-500",children:[(0,t.jsx)("span",{children:"Your baseline"}),(0,t.jsx)("span",{className:"text-gray-300",children:v(y)})]}),w>0&&(0,t.jsxs)("div",{className:"flex justify-between text-gray-500",children:[(0,t.jsxs)("span",{children:["Strain adjustment (strain was ",f.toFixed(1),")"]}),(0,t.jsxs)("span",{className:"text-purple-400",children:["+",w,"m"]})]}),b>0&&(0,t.jsxs)("div",{className:"flex justify-between text-gray-500",children:[(0,t.jsxs)("span",{children:["Debt repayment (",v(b)," total)"]}),(0,t.jsxs)("span",{className:"text-purple-400",children:["+",S,"m"]})]})]}),b>.5&&(0,t.jsxs)("div",{className:"mt-4 pt-3 border-t border-gray-800 text-xs text-gray-500 text-center",children:["Sleep debt: ",v(b)," accumulated over 7 days"]})]}),o&&(0,t.jsxs)("div",{className:"bg-gray-900 rounded-2xl p-4 relative",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,t.jsx)("div",{className:"text-gray-500 text-xs",children:"SLEEP STAGES"}),(0,t.jsx)(x,{onClick:()=>n("sleep_stages")})]}),(0,t.jsxs)("div",{className:"h-8 rounded-lg overflow-hidden flex",children:[(0,t.jsx)("div",{className:"bg-indigo-700 transition-all",style:{width:`${o.deep_pct}%`}}),(0,t.jsx)("div",{className:"bg-cyan-500 transition-all",style:{width:`${o.rem_pct}%`}}),(0,t.jsx)("div",{className:"bg-purple-400 transition-all",style:{width:`${100-o.deep_pct-o.rem_pct}%`}})]}),(0,t.jsxs)("div",{className:"flex justify-between mt-4 text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded bg-indigo-700"}),(0,t.jsx)("span",{className:"text-gray-400",children:"Deep"}),(0,t.jsxs)("span",{className:"font-medium",children:[o.deep_pct.toFixed(0),"%"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded bg-cyan-500"}),(0,t.jsx)("span",{className:"text-gray-400",children:"REM"}),(0,t.jsxs)("span",{className:"font-medium",children:[o.rem_pct.toFixed(0),"%"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded bg-purple-400"}),(0,t.jsx)("span",{className:"text-gray-400",children:"Light"}),(0,t.jsxs)("span",{className:"font-medium",children:[(100-o.deep_pct-o.rem_pct).toFixed(0),"%"]})]})]})]}),(0,t.jsxs)("div",{className:"bg-gray-900 rounded-2xl p-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsxs)("div",{className:"text-gray-500 text-xs",children:[l,"-DAY SLEEP"]}),(0,t.jsx)(N,{value:l,onChange:i})]}),(0,t.jsx)("div",{className:"h-28 flex items-end gap-0.5 overflow-x-auto",children:d.map((s,r)=>{let n=c[c.length-1-r],i=n?.date===e.date,o=l<=14?"flex-1":l<=30?"min-w-[8px] flex-shrink-0":"min-w-[4px] flex-shrink-0";return(0,t.jsx)("button",{onClick:()=>n&&a(n),className:`${o} rounded-t transition-all ${i?"ring-1 ring-white":""}`,style:{height:`${s/h*100}%`,backgroundColor:"#A855F7",minHeight:s>0?"4px":"0"}},r)})}),(0,t.jsxs)("div",{className:"flex justify-between mt-2",children:[(0,t.jsx)("div",{className:"text-[10px] text-gray-600",children:"Target: 7-9 hours"}),(0,t.jsxs)("div",{className:"text-[10px] text-gray-600",children:["Avg: ",(d.reduce((e,t)=>e+t,0)/d.filter(e=>e>0).length).toFixed(1),"h"]})]})]}),o?.score&&(0,t.jsx)("div",{className:"bg-gray-900 rounded-2xl p-4",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-gray-400",children:"Sleep Score"}),(0,t.jsx)("span",{className:"text-2xl font-bold text-purple-400",children:o.score})]})})]})}function E({direction:e}){return e?"up"===e.direction?(0,t.jsxs)("span",{className:"text-green-400 ml-1",children:["+",Math.abs(e.change_pct).toFixed(1),"%"]}):"down"===e.direction?(0,t.jsxs)("span",{className:"text-red-400 ml-1",children:["-",Math.abs(e.change_pct).toFixed(1),"%"]}):(0,t.jsx)("span",{className:"text-gray-500 ml-1",children:"--"}):null}function $({label:e,value:s,unit:r,color:a,progress:n,subtext:l,direction:i,baselineLabel:o,infoKey:c,onShowInfo:d}){return(0,t.jsxs)("div",{className:"bg-gray-900 rounded-2xl p-4 relative",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,t.jsx)("div",{className:"text-gray-500 text-xs",children:e}),c&&d&&(0,t.jsx)(x,{onClick:()=>d(c)})]}),(0,t.jsxs)("div",{className:"flex items-baseline gap-1",children:[(0,t.jsx)("span",{className:"text-2xl font-bold",style:{color:a},children:s}),(0,t.jsx)("span",{className:"text-gray-600 text-sm",children:r}),(0,t.jsx)(E,{direction:i})]}),i?.baseline&&(0,t.jsxs)("div",{className:"text-gray-600 text-xs mt-1",children:[o||"vs 7d avg",": ",i.baseline.toFixed(1)]}),l&&!i?.baseline&&(0,t.jsx)("div",{className:"text-gray-600 text-xs mt-1",children:l}),void 0!==n&&(0,t.jsx)("div",{className:"mt-3 h-1.5 bg-gray-800 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full rounded-full transition-all duration-500",style:{width:`${Math.min(100,100*n)}%`,backgroundColor:a}})})]})}function P({label:e,value:s,baseline:r,unit:a,direction:n,inverse:l=!1}){let i=n?l?"down"===n.direction||"up"===n.direction&&n.change_pct<0:"up"===n.direction:void 0,o=n?l?"up"===n.direction&&n.change_pct>0:"down"===n.direction:void 0;return(0,t.jsxs)("div",{className:"bg-gray-900 rounded-xl p-4 flex justify-between items-center",children:[(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-gray-400",children:e}),r&&(0,t.jsxs)("span",{className:"text-gray-600 text-xs",children:["baseline: ","number"==typeof r?r.toFixed(1):r,a]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("span",{className:`font-medium ${i?"text-green-400":o?"text-red-400":""}`,children:[null!=s?"number"==typeof s?s.toFixed(1):s:"--",a]}),n&&"stable"!==n.direction&&(0,t.jsxs)("span",{className:i?"text-green-400":o?"text-red-400":"text-gray-500",children:["up"===n.direction?"+":"",n.change_pct.toFixed(0),"%"]}),n?.direction==="stable"&&(0,t.jsx)("span",{className:"text-gray-500 text-xs",children:"stable"})]})]})}e.s(["default",()=>S],52683)}]);